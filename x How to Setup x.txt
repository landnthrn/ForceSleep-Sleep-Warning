
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

HOW TO SETUP FORCESLEEP/SLEEPWARNING:

Go to your documents folder 

Create a folder called 'Scripts'

Create another folder inside the Scripts folder called ForceSleep

Place all the files from this download into there

Windows Search for Environment Variables

Once the System Properties tab opens select Environment Variables again

Under the User Variables top box select Path then Edit

Select New and paste the path of your ForceSleep folder it should be like C:\Users\%USERNAME%\Documents\Scripts\ForceSleep
Optional but fullproofed to add the Scripts folder path too C:\Users\%USERNAME%\Documents\Scripts

Recommended to replace the %USERNAME% parts with your PC username,
so say it was Elephant it would be C:\Users\Elephant\Documents\Scripts

Click Ok a few times to close Environment Variables

Open Command Prompt as Admin

Edit this following command before running it, replace %USERNAME% with your PC username there's two to replace

THE COMMAND:
schtasks /create /tn "ForceSleep_Watcher" /tr "powershell.exe -NoProfile -NoLogo -ExecutionPolicy Bypass -WindowStyle Hidden -File \"C:\Users\%USERNAME%\Documents\Scripts\ForceSleep\forcesleep.ps1\"" /sc ONLOGON /ru "%USERNAME%" /it /rl LIMITED

Once you've created the ForceSleep_Watcher task with that command 

Open Task Schedular, find the ForceSleep_Watcher task

Right click it > Properties > Settings > Make sure that "Stop the task if it runs longer than" setting is set to 3 days

Close Task Schedular 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

TEST IF IT WORKS:

Open the ForceSleep.ps1 file (Right click > Edit)

At the top change $ThresholdMinutes = 25 to $ThresholdMinutes = 0.5
This is make it trigger within at 30 seconds of idle time

Save changes to the ForceSleep.ps1 file

Note: Everytime you make a change to these files you should restart the ForceSleep_Watcher task by using this command in Command Prompt Admin:
schtasks /end /tn "ForceSleep_Watcher" & timeout /t 2 /nobreak >nul & schtasks /run /tn "ForceSleep_Watcher"

Once you've restarted the task, don't touch your mouse or keyboard for 30 seconds and see if the Sleep Warning appears, if so don't cancel it so you can see if it sleeps properly.

After you've verified it works, open the ForceSleep.ps1 again and change the $ThresholdMinutes = 0.5 to any number of minutes you'd like, then save

Restart the task again with this command:
schtasks /end /tn "ForceSleep_Watcher" & timeout /t 2 /nobreak >nul & schtasks /run /tn "ForceSleep_Watcher"

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

INFO:
You can cancel the sleep from happening by pressing Ctrl + C or pause it by clicking inside the terminal pop up and resume it by pressing any key

If you have media/audio playing it will pause it before sleep to prevent audio tasks from thinking something crashed

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Find more of my creations on Github:
https://github.com/landnthrn?tab=repositories

Support me on Buy Me a Coffee
https://buymeacoffee.com/landn.thrn

Paypal Donation:
https://www.paypal.com/donate/?hosted_button_id=K4PLHFVBH7X8C

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

























